<div align="center">
  <img src=".github/autosa_logo.png", width="200">
</div>

# AutoSA: Polyhedral-Based Systolic Array Auto-Compilation

This repository includes the code for AutoSA. **AutoSA** is an end-to-end systolic array compiler based on the polyhedral model. It takes algorithms in high-level programming languages (C) as inputs, performs polyhedral transformation and other architecture optimization to map algorithms to systolic array architecture. The generated designs are in HLS C.

The structure of this repo is as follows:
```

.
|-- README.md: this file
|-- src: directory for AutoSA source code
    |-- isl: directory for Integer Set Library (isl)
    |-- pet: directory for Polyhedral Extraction Tool (pet)
|-- autosa_config: directory for AutoSA configuration files
|-- autosa_scripts: directory for AutoSA scripts
|-- autosa_tests: directory for AutoSA test code
|-- autosa.tmp: directory for temporary file generated by AutoSA
    |-- output: directory for generated code by AutoSA
        |-- src: diretory for generated HLS C kernel code and OpenCL host code
        |-- latency_est: directory for metadata used for latency estimation of the generated design
        |-- resource_est: directory for metadata used for resource estimation of the generated design
    |-- optimizer: directory for intermediate files generated by AutoSA Optimizer
```

## Contents
1. [Latest Features](#latest-features)
2. [Prerequisites](#prerequisites)
3. [Getting Started](#getting-started)
4. [Send Us Failure Cases and Feedback!](#send-us-failure-cases-and-feedback)
5. [Authors and Contributions](#authors-and-contributions)

## Latest Features


## Prerequisites
AutoSA is build upon PPCG 0.08.3 (source repository: http://repo.or.cz/ppcg.git).
Below are the requirements for installing PPCG:
- automake, autoconf, libtool
	(not needed when compiling a release)
- pkg-config (http://www.freedesktop.org/wiki/Software/pkg-config)
	(not needed when compiling a release using the included isl and pet)
- gmp (http://gmplib.org/)
- libyaml (http://pyyaml.org/wiki/LibYAML)
	(only needed if you want to compile the pet executable)
- LLVM/clang libraries, 2.9 or higher (http://clang.llvm.org/get_started.html)
	Unless you have some other reasons for wanting to use the svn version,
	it is best to install the latest release (3.9).
	For more details, see pet/README.

If you are installing on Ubuntu, then you can install the following packages:

automake autoconf libtool pkg-config libgmp3-dev libyaml-dev libclang-dev llvm

Note that you need at least version 3.2 of libclang-dev (ubuntu raring).
Older versions of this package did not include the required libraries.
If you are using an older version of ubuntu, then you need to compile and
install LLVM/clang from source.

## Getting Started
### Compilation
```bash
./install.sh
```

### Use AutoSA to generate HLS code
1. Annotate the code region to be transformed to HLS C.

Insert a line containing 
```c
#pragma scop
```
before the fragment and add a line containing
```c
#pragma endscop
```
after the fragment.

2. Generate HLS C and OpenCL host code.

Run
```c
autosa --target=autosa_hls --autosa file.c
```
where `file.c` is the file containing the fragment. The generated code can be found in `autosa.tmp/output/src/file_host.cpp` and `autosa.tmp/output/src/file_kernel.c`.

## Send Us Failure Cases and Feedback!
AutoSA is open source for research purposes, and we would like to continously improve it! Please let us know if...

1. you find any bug in the AutoSA code.
2. you find any application that fails the compilation flow of AutoSA.
3. you know how to further help improve any part of the compiler.
4. etc.

## Authors and Contributors
AutoSA is currently maintained by [Jie Wang](http://cadlab.cs.ucla.edu/~jaywang/).
Besides, we gratefully acknowledge the authors of PPCG for developing and actively maintaining PPCG as an open-source project.

## Version History

